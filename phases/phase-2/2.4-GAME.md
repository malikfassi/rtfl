# Milestone 2.4: Game Logic

## Current Status
âœ… Core Game Logic
- Word masking implemented
- Basic state management done
- Initial API routes working

## Required Changes

### 1. Fix Linter Errors ðŸš§
- [ ] Fix unused parameters in state.ts
  - [ ] Add underscore prefix to unused params
  - [ ] Remove unused imports
  - [ ] Fix RevealState type issues

### 2. Progress & Win Condition Updates ðŸš§
- [ ] Update progress calculation
  - [ ] Track title/artist words separately
  - [ ] Track lyrics words separately
  - [ ] Win condition: (title AND artist complete) OR (80% lyrics)
  - [ ] Update tests for new win conditions

### 3. State Management Refactor ðŸš§
- [ ] Update GameState interface
  - [ ] Add separate progress tracking (title/artist vs lyrics)
  - [ ] Add reveal state management
  - [ ] Update state computation
  - [ ] Fix failing tests

### 4. Route Updates ðŸš§
- [ ] Update GET /games/:date
  - [ ] Use existing db functions
  - [ ] Add proper error handling
  - [ ] Add response filtering
- [ ] Update POST /games/:date/guess
  - [ ] Use existing db functions
  - [ ] Add proper validation
  - [ ] Return correct progress info

### 5. Testing Framework ðŸš§
- [ ] Update existing tests for new logic
  - [ ] Update progress calculation tests
  - [ ] Update win condition tests
  - [ ] Add reveal state tests
- [ ] Add new test cases
  - [ ] Title/artist completion
  - [ ] 80% lyrics completion
  - [ ] Reveal state transitions

## Implementation Steps
1. Fix linter errors and failing tests
2. Update progress calculation and win conditions
3. Update state management
4. Update route handlers
5. Update and add tests

## Dependencies
- Keep existing database operations
- Maintain backward compatibility
- Ensure proper error handling
```